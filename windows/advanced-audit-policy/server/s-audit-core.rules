# Server File/Folder auditing rules
# For: win-forgery.ps1  (Apply to "This folder and files" / no subfolders)
# Format: id|path|perm|note
#
# IMPORTANT (multi-profile coverage):
#  - On servers there can be many local profiles.
#  - Use wildcard paths like "%SystemDrive%\Users\*\Desktop".
#  - win-forgery.ps1 v4 expands wildcards to existing paths before applying SACL.

file_hosts|$env:SystemRoot\System32\drivers\etc\hosts|CreateFiles,Delete|hosts tamper
file_winevt_logs|$env:SystemRoot\System32\winevt\Logs|Delete|event log files delete (anti-forensics)
file_sam|$env:SystemRoot\System32\config\SAM|ReadAttributes|SAM access attempt

# Startup folders (All Users + ALL profiles)
file_startup_allusers|$env:ProgramData\Microsoft\Windows\Start Menu\Programs\Startup|CreateFiles,Delete|All Users Startup folder
file_startup_allprofiles|$env:SystemDrive\Users\*\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup|CreateFiles,Delete|Per-user Startup (all profiles)

file_tasks|$env:SystemRoot\System32\Tasks|CreateFiles,Delete|Scheduled Tasks folder (file traces)

# Honeypot (all profiles) - only applies if folders exist
file_honeypot_allprofiles|$env:SystemDrive\Users\*\Documents\Client_Contracts|CreateFiles,Delete,AppendData,WriteData|PLURA honeypot (all profiles)

# High-signal on servers
file_desktop_allprofiles|$env:SystemDrive\Users\*\Desktop|CreateFiles,Delete|All profile Desktops (server: high-signal)
file_roaming_allprofiles|$env:SystemDrive\Users\*\AppData\Roaming|CreateFiles,Delete|Roaming AppData roots (server: suspicious)
file_recyclebin|$env:SystemDrive\$Recycle.Bin|FullControl|Recycle Bin (server: suspicious)

file_oledb|$env:ProgramFiles\Common Files\System\Ole DB|CreateFiles|Ole DB folder (rare on servers)

