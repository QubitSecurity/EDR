<!-- PLURA_CONFIG_VERSION: d-sysmon-plura-v3.1.xml --> 
<!-- PLURA_SCHEMA_TARGET: 4.90 -->

<Sysmon schemaversion="4.90">
  <HashAlgorithms>*</HashAlgorithms>
  <CheckRevocation>False</CheckRevocation>
  <DnsLookup>False</DnsLookup>
  <ArchiveDirectory>Sysmon</ArchiveDirectory>
  <EventFiltering>
    <!-- ============================================================ -->
    <!-- Event ID 1: Process Create (Desktop: LOLBAS/스크립트/브라우저 기반 초기침투 중심) -->
    <!-- ============================================================ -->
    <!-- (1) 노이즈/PLURA 자체 프로세스 제외 -->
    <RuleGroup name="ProcessCreate-Exclude-Noise" groupRelation="or">
      <ProcessCreate onmatch="exclude">
        <!-- PLURA Agent / Tools -->
        <ParentImage condition="end with">\Program Files (x86)\PLURA\PLURAService.exe</ParentImage>
        <ParentImage condition="end with">\Program Files (x86)\PLURA\PLURASControl.exe</ParentImage>
        <ParentImage condition="end with">\Program Files (x86)\PLURA\PLURAConfig.exe</ParentImage>
        <ParentImage condition="end with">\Program Files (x86)\PLURA\PLURATray.exe</ParentImage>
        <!-- Windows common noise -->
        <Image condition="end with">\Windows\System32\RuntimeBroker.exe</Image>
        <Image condition="end with">\Windows\System32\backgroundTaskHost.exe</Image>
        <!-- .NET ngen / mscorsvw compilation noise -->
        <CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image>
        <Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image>
      </ProcessCreate>
    </RuleGroup>
    <!-- (2) Desktop 주요 공격 표면 Include -->
    <RuleGroup name="ProcessCreate-Include-Desktop" groupRelation="or">
      <ProcessCreate onmatch="include">
        <!-- Script / LOLBAS -->
        <Image condition="end with">\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</Image>
        <Image condition="end with">\Windows\System32\pwsh.exe</Image>
        <Image condition="end with">\Windows\System32\cmd.exe</Image>
        <Image condition="end with">\Windows\System32\cscript.exe</Image>
        <Image condition="end with">\Windows\System32\wscript.exe</Image>
        <Image condition="end with">\Windows\System32\mshta.exe</Image>
        <Image condition="end with">\Windows\System32\rundll32.exe</Image>
        <Image condition="end with">\Windows\System32\regsvr32.exe</Image>
        <!-- Downloaders / living-off-the-land -->
        <Image condition="end with">\Windows\System32\certutil.exe</Image>
        <Image condition="end with">\Windows\System32\bitsadmin.exe</Image>
        <Image condition="end with">\Windows\System32\curl.exe</Image>
        <Image condition="end with">\Windows\System32\wget.exe</Image>
        <!-- Office child processes are high signal -->
        <Image condition="end with">\WINWORD.EXE</Image>
        <Image condition="end with">\EXCEL.EXE</Image>
        <Image condition="end with">\POWERPNT.EXE</Image>
        <Image condition="end with">\OUTLOOK.EXE</Image>
        <!-- Browsers -->
        <Image condition="end with">\chrome.exe</Image>
        <Image condition="end with">\msedge.exe</Image>
        <Image condition="end with">\firefox.exe</Image>
        <!-- Suspicious execution in user-writable locations -->
        <Rule groupRelation="and">
          <Image condition="contains">\Users\</Image>
          <Image condition="contains any">\AppData\;\Downloads\;\Desktop\;</Image>
        </Rule>
        <Rule groupRelation="and">
          <Image condition="contains">\AppData\Local\Temp\</Image>
        </Rule>
      </ProcessCreate>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 3: Network Connect (Desktop: 브라우저/스크립트 엔진/원격도구 중심) -->
    <!-- ============================================================ -->
    <!-- (1) 노이즈/PLURA 제외 -->
    <RuleGroup name="NetworkConnect-Exclude-Noise" groupRelation="or">
      <NetworkConnect onmatch="exclude">
        <!-- PLURA -->
        <Image condition="contains">:\Program Files (x86)\PLURA\</Image>
        <!-- Multicast / loopback -->
        <SourceIp condition="begin with">224.0.0.</SourceIp>
        <SourceIp condition="begin with">ff02:0:0:0:0:0:1:</SourceIp>
        <SourceIp condition="is">239.255.255.250</SourceIp>
        <SourceIp condition="is">0:0:0:0:0:0:0:1</SourceIp>
        <DestinationIp condition="is">239.255.255.250</DestinationIp>
        <DestinationIp condition="is">0:0:0:0:0:0:0:1</DestinationIp>
        <!-- Windows Update / Microsoft -->
      </NetworkConnect>
    </RuleGroup>
    <!-- (2) 고신호 Outbound Include -->
    <RuleGroup name="NetworkConnect-Include-Desktop" groupRelation="or">
      <NetworkConnect onmatch="include">
        <!-- PowerShell outbound -->
        <Image condition="end with">\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
        <Image condition="end with">\Windows\System32\pwsh.exe</Image>
        <!-- Script engines outbound -->
        <Image condition="end with">\Windows\System32\wscript.exe</Image>
        <Image condition="end with">\Windows\System32\cscript.exe</Image>
        <Image condition="end with">\Windows\System32\mshta.exe</Image>
        <!-- LOLBins outbound -->
        <!-- RDP / SMB / WinRM indicative ports -->
        <Image condition="end with">\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\wscript.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\cscript.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\mshta.exe</Image>
        <Image condition="end with">\Windows\System32\rundll32.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\rundll32.exe</Image>
        <Image condition="end with">\Windows\System32\regsvr32.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\regsvr32.exe</Image>
        <Image condition="end with">\Windows\System32\wmic.exe</Image>
        <Image condition="end with">\Windows\SysWOW64\wmic.exe</Image>
        <Image condition="end with">\Windows\System32\certutil.exe</Image>
        <Image condition="end with">\Windows\System32\bitsadmin.exe</Image>
        <Image condition="end with">\Windows\System32\curl.exe</Image>
        <Image condition="end with">\Windows\System32\wget.exe</Image>
        <DestinationPort condition="is">3389</DestinationPort>
        <DestinationPort condition="is">445</DestinationPort>
        <DestinationPort condition="is">5985</DestinationPort>
        <DestinationPort condition="is">5986</DestinationPort>
      </NetworkConnect>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 5: Process Terminate (기본 노이즈 제외) -->
    <!-- ============================================================ -->
    <RuleGroup name="ProcessTerminate-Exclude-Noise" groupRelation="or">
      <ProcessTerminate onmatch="exclude">
        <Image condition="end with">\Windows\System32\backgroundTaskHost.exe</Image>
        <Image condition="end with">\Windows\System32\RuntimeBroker.exe</Image>
        <Image condition="end with">\Sysmon\Sysmon64.exe</Image>
        <Image condition="end with">\Sysmon\Sysmon.exe</Image>
      </ProcessTerminate>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 7: ImageLoad (PowerShell 관련 DLL 로딩 추적 유지) -->
    <!-- ============================================================ -->
    <RuleGroup name="ImageLoad-PowerShell" groupRelation="and">
      <ImageLoad onmatch="include">
        <Rule groupRelation="or">
          <ImageLoaded condition="contains">System.Management.Automation</ImageLoaded>
          <ImageLoaded condition="contains">System.Reflection</ImageLoaded>
          <ImageLoaded condition="contains">sspisrv.dll</ImageLoaded>
        </Rule>
      </ImageLoad>
      <ImageLoad onmatch="exclude">
        <Rule groupRelation="or">
          <Image condition="end with">\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</Image>
          <Image condition="end with">\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Image>
          <Image condition="end with">\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe</Image>
        </Rule>
      </ImageLoad>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 9: RawAccessRead (데스크톱에서도 유효하지만 노이즈 관리) -->
    <!-- ============================================================ -->
    <RuleGroup name="RawAccessRead-Desktop" groupRelation="and">
      <RawAccessRead onmatch="include">
        <Device condition="contains">\Device\Harddisk0\DR0</Device>
      </RawAccessRead>
      <RawAccessRead onmatch="exclude">
        <Rule groupRelation="or">
          <Image condition="contains all">\ProgramData\Microsoft\Windows Defender\platform\;\MsMpEng.exe</Image>
          <Image condition="contains">\Windows\System32\</Image>
          <Image condition="contains">\Windows\SysWOW64\</Image>
        </Rule>
      </RawAccessRead>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 11: FileCreate (Desktop: 사용자 경로/다운로드/오피스/시작프로그램/스크립트 중심) -->
    <!-- ============================================================ -->
    <RuleGroup name="FileCreate-Include-DesktopCore" groupRelation="or">
      <FileCreate onmatch="include">
        <!-- Startup / Start Menu -->
        <TargetFilename condition="contains">\Start Menu</TargetFilename>
        <TargetFilename condition="contains">\Startup\</TargetFilename>
        <!-- Downloads / Desktop / Temp -->
        <Rule groupRelation="and">
          <TargetFilename condition="contains any">\Downloads\;\Desktop\;\AppData\Local\Temp\;</TargetFilename>
          <TargetFilename condition="contains any">.exe;.dll;.ps1;.vbs;.js;.jse;.hta;.bat;.cmd;.scr;.msi;.lnk</TargetFilename>
        </Rule>
        <!-- Office & email attachment caches -->
        <TargetFilename condition="contains">\Content.Outlook\</TargetFilename>
        <TargetFilename condition="contains">\INetCache\Content.Outlook\</TargetFilename>
        <TargetFilename condition="contains any">.docm;.xlsm;.pptm;.rtf;.lnk;.iso;.img</TargetFilename>
        <!-- Key system locations worth watching even on desktop -->
        <TargetFilename condition="begin with">C:\Windows\System32\drivers\etc\hosts</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\Tasks\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\Tasks\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks\</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
        <TargetFilename condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>
        <!-- Browser extensions (install/persistence) -->
        <TargetFilename condition="contains">\AppData\Local\Google\Chrome\User Data\Default\Extensions\</TargetFilename>
        <TargetFilename condition="contains">\AppData\Local\Microsoft\Edge\User Data\Default\Extensions\</TargetFilename>
      </FileCreate>
    </RuleGroup>
    <RuleGroup name="FileCreate-Exclude-PLURA" groupRelation="or">
      <FileCreate onmatch="exclude">
        <Image condition="end with">\Program Files (x86)\PLURA\PLURAService.exe</Image>
        <Image condition="end with">\Program Files (x86)\PLURA\PLURASControl.exe</Image>
        <Image condition="end with">\Program Files (x86)\PLURA\PLURAConfig.exe</Image>
        <Image condition="end with">\Program Files (x86)\PLURA\PLURATray.exe</Image>
      </FileCreate>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 12/13/14: RegistryEvent (Desktop persistence / policy tamper 중심) -->
    <!-- ============================================================ -->
    <RuleGroup name="RegistryEvent-Include-DesktopCore" groupRelation="or">
      <RegistryEvent onmatch="include">
        <!-- Run keys / Startup -->
        <TargetObject condition="contains">\CurrentVersion\Run</TargetObject>
        <TargetObject condition="contains">\Policies\Explorer\Run</TargetObject>
        <TargetObject condition="contains">Explorer\User Shell Folders\Startup</TargetObject>
        <!-- Winlogon -->
        <TargetObject condition="contains">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</TargetObject>
        <!-- IFEO -->
        <TargetObject condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
        <!-- PowerShell logging tamper -->
        <TargetObject condition="contains">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging</TargetObject>
        <TargetObject condition="contains">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
        <TargetObject condition="contains">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
        <!-- Defender tamper (common desktop scenario) -->
        <TargetObject condition="contains">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>
      </RegistryEvent>
    </RuleGroup>
    <RuleGroup name="RegistryEvent-Exclude-PLURA-Noise" groupRelation="or">
      <RegistryEvent onmatch="exclude">
        <Image condition="begin with">C:\Program Files (x86)\PLURA\</Image>
        <Image condition="begin with">C:\Program Files\PLURA\</Image>
      </RegistryEvent>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 15: FileCreateStreamHash (Zone.Identifier / scripts) -->
    <!-- ============================================================ -->
    <RuleGroup name="FileCreateStreamHash-Desktop" groupRelation="or">
      <FileCreateStreamHash onmatch="include">
        <Rule name="ZoneIdentifier" groupRelation="and">
          <TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
          <Contents condition="contains any">about:internet;blob:</Contents>
        </Rule>
        <TargetFilename condition="end with">.ps1</TargetFilename>
        <TargetFilename condition="end with">.psm1</TargetFilename>
        <TargetFilename condition="end with">.vbs</TargetFilename>
        <TargetFilename condition="end with">.js</TargetFilename>
      </FileCreateStreamHash>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 22: DNS Query (Desktop: 특정 IOC 유지 가능) -->
    <!-- ============================================================ -->
    <RuleGroup name="DnsQuery-IOC" groupRelation="or">
      <DnsQuery onmatch="include">
        <!-- 기존 예시 IOC 유지(필요 시 교체) -->
        <QueryName condition="end with">tcjst.com</QueryName>
      </DnsQuery>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 23/26: FileDelete / FileDeleteDetected -->
    <!-- - 23은 디스크 영향 고려: off 유지 -->
    <!-- - 26은 사용자 경로/임시폴더 기반 삭제 행위 중심 -->
    <!-- ============================================================ -->
    <RuleGroup name="FileDelete-ArchivedCopy-Disabled" groupRelation="or">
      <FileDelete onmatch="exclude"/>
    </RuleGroup>
    <RuleGroup name="FileDeleteDetected-Include-DesktopCore" groupRelation="or">
      <FileDeleteDetected onmatch="include">
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
          <TargetFilename condition="contains any">.exe;.dll;.ps1;.vbs;.js;.jse;.hta;.bat;.cmd;.scr;.msi;.lnk</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
          <TargetFilename condition="contains any">.exe;.dll;.ps1;.vbs;.js;.jse;.hta;.bat;.cmd;.scr;.msi;.lnk</TargetFilename>
        </Rule>
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\INetCache\Content.Outlook\</TargetFilename>
          <TargetFilename condition="contains any">.exe;.dll;.ps1;.vbs;.js;.jse;.hta;.bat;.cmd;.scr;.msi;.lnk;.docm;.xlsm;.pptm;.rtf</TargetFilename>
        </Rule>
      </FileDeleteDetected>
    </RuleGroup>
    <RuleGroup name="FileDeleteDetected-Exclude-CommonNoise" groupRelation="or">
      <FileDeleteDetected onmatch="exclude">
        <Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
        <User condition="contains any">NETWORK SERVICE;LOCAL SERVICE</User>
      </FileDeleteDetected>
    </RuleGroup>
    <!-- ============================================================ -->
    <!-- Event ID 8: CreateRemoteThread (Injection signal) -->
    <!-- ============================================================ -->
    <RuleGroup name="CreateRemoteThread-Include" groupRelation="or">
      <CreateRemoteThread onmatch="include">
        <SourceImage condition="begin with">C:\</SourceImage>
        <SourceImage condition="begin with">\\</SourceImage>
      </CreateRemoteThread>
    </RuleGroup>
    <!-- ============================================================ -->
    

    <!-- SYSMON EVENT ID 29 : FILE EXECUTABLE DETECTED [FileExecutableDetected] - Desktop (강화 버전) -->

    <!-- INCLUDE: 악성 Drop/Run 경로 + PowerShell/LOLBin까지 강하게 탐지 -->
    <RuleGroup name="Include_MalwareDrop_Desktop" groupRelation="or">
      <FileExecutableDetected onmatch="include">

        <!-- (A) 사용자 데이터 보호 (Honeypot) -->
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\</TargetFilename>
          <TargetFilename condition="contains any">
            \Documents\;
            \Pictures\;
            \Videos\;
            \Music\;
            \Favorites\;
            \Client_Contracts\
          </TargetFilename>
        </Rule>

        <!-- (B) 공격자 임시 Drop & Run 경로
               - 사용자 임시 폴더, Temp, Downloads 등 -->
        <Rule groupRelation="or">
          <!-- 사용자 임시 폴더 -->
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
          <!-- Windows Temp -->
          <TargetFilename condition="contains">\Windows\Temp\</TargetFilename>
          <!-- Downloads 디렉터리 -->
          <TargetFilename condition="contains">\Downloads\</TargetFilename>
        </Rule>

        <!-- (C) 공격자들이 자주 사용하는 Drop 경로 (예: C:\ProgramData, Public 등) -->
        <Rule groupRelation="or">
          <TargetFilename condition="begin with">C:\ProgramData\</TargetFilename>
          <TargetFilename condition="begin with">C:\Users\Public\</TargetFilename>
        </Rule>

        <!-- (D) PowerShell 스크립트 실행 탐지 -->
        <Rule groupRelation="or">
          <TargetFilename condition="end with">.ps1</TargetFilename>
          <TargetFilename condition="end with">.psm1</TargetFilename>
          <TargetFilename condition="end with">.psd1</TargetFilename>
        </Rule>

        <!-- (E) LOLBin/LOLScript Drop & Run 패턴 탐지 -->
        <Rule groupRelation="or">
          <!-- 공용 LOLBin 위치 -->
          <TargetFilename condition="end with">\certutil.exe</TargetFilename>
          <TargetFilename condition="end with">\bitsadmin.exe</TargetFilename>
          <TargetFilename condition="end with">\mshta.exe</TargetFilename>
          <TargetFilename condition="end with">\wscript.exe</TargetFilename>
          <TargetFilename condition="end with">\cscript.exe</TargetFilename>
          <TargetFilename condition="end with">\powershell.exe</TargetFilename>
          <TargetFilename condition="end with">\pwsh.exe</TargetFilename>
          <TargetFilename condition="end with">\regsvr32.exe</TargetFilename>
        </Rule>

        <!-- (F) Office 매크로가 드랍하는 실행 파일 (일반적인 Temp 위치) -->
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
          <TargetFilename condition="end with">.exe</TargetFilename>
        </Rule>

        <!-- (G) 악성 Word/Excel 매크로에서 Dropping하는 경로 (예시) -->
        <Rule groupRelation="and">
          <TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\</TargetFilename>
          <TargetFilename condition="end with">.lnk</TargetFilename>
        </Rule>

        <!-- (H) 사용자 프로파일 하위의 Run/Startup 경로 악성 Drop -->
        <Rule groupRelation="and">
          <TargetFilename condition="begin with">C:\Users\</TargetFilename>
          <TargetFilename condition="contains any">
            \AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\;
            \AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\;
            \AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\
          </TargetFilename>
        </Rule>

      </FileExecutableDetected>
    </RuleGroup>



    <!-- INCLUDE: LOLBAS Writer Process 기반 PE Drop 탐지 (Strict) -->
    <RuleGroup name="Include_LOLBAS_FileExecutableDetected_Desktop_Strict" groupRelation="or">
      <FileExecutableDetected onmatch="include">
        <Rule groupRelation="and">
          <Image condition="end with">\AddinUtil.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\AppInstaller.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Aspnet_Compiler.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\At.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Atbroker.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Bash.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Bitsadmin.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\CertOC.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\CertReq.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Certutil.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Change.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Cipher.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Cmd.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Cmdkey.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Cmstp.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Colorcpl.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\ComputerDefaults.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\ConfigSecurityPolicy.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Conhost.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Control.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Csc.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Cscript.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\CustomShellHost.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\DataSvcUtil.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Desktopimgdownldr.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\DeviceCredentialDeployment.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Dfsvc.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Diantz.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Diskshadow.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Dnscmd.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Esentutl.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Eudcedit.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Eventvwr.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Expand.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Explorer.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Extexport.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Extrac32.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Findstr.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Finger.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Forfiles.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Fsutil.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ftp.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Gpscript.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Hh.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\IMEWDBLD.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ie4uinit.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ieexec.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ilasm.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Infdefaultinstall.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Installutil.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Jsc.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ldifde.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Makecab.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Mavinject.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Microsoft.Workflow.Compiler.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Mmc.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\MpCmdRun.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Msbuild.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Msconfig.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Msdt.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Msedge.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Mshta.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Msiexec.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Netsh.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ngen.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Odbcconf.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\OfflineScannerShell.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\OneDriveStandaloneUpdater.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Pcalua.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Pcwrun.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Pktmon.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Pnputil.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Presentationhost.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Print.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\PrintBrm.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Provlaunch.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Psr.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Query.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Rasautou.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Reg.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Regasm.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Regedit.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Regini.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Register-cimprovider.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Regsvcs.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Regsvr32.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Replace.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Reset.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Rpcping.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Rundll32.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Runexehelper.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Runonce.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Runscripthelper.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Sc.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Schtasks.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Scriptrunner.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Setres.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\SettingSyncHost.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Sftp.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Stordiag.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\SyncAppvPublishingServer.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Tar.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Ttdinject.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Tttracer.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Unregmp2.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Verclsid.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Wab.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Wlrmdr.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Wmic.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\WorkFolders.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Wscript.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Wsreset.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\Xwizard.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\cmdl32.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\fltMC.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\iediagcmd.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\iscsicpl.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\msedge_proxy.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\msedgewebview2.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\rdrleakdiag.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\ssh.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\vbc.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\wbadmin.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\wbemtest.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\winget.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\wt.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <Image condition="end with">\wuauclt.exe</Image>
          <TargetFilename condition="contains any">C:\Users\;C:\Users\Public\;C:\ProgramData\;C:\Windows\Temp\;C:\Temp\;</TargetFilename>
        </Rule>

      </FileExecutableDetected>
    </RuleGroup>
    <!-- EXCLUDE: 정상 소프트웨어 / 업데이트 / 패치 프로세스 등 허용 -->
    <RuleGroup name="Exclude_LegitActivity_Desktop" groupRelation="or">
      <FileExecutableDetected onmatch="exclude">

        <!-- (1) Microsoft Office 정식 설치 프로그램 -->
        <Rule groupRelation="and">
          <Image condition="contains">\Office\setup.exe</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (2) Adobe Reader / Acrobat 설치 및 업데이트 -->
        <Rule groupRelation="and">
          <Image condition="contains">\Adobe\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (3) Google Chrome / Edge WebView 업데이트 -->
        <Rule groupRelation="and">
          <Image condition="contains any">\Google\Update\;\Google\Chrome\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (4) Microsoft Edge 업데이트 -->
        <Rule groupRelation="and">
          <Image condition="contains">\Microsoft\EdgeUpdate\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (5) Zoom / WebEx / Teams 등 Collaboration 툴 -->
        <Rule groupRelation="and">
          <Image condition="contains">\zoom\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (6) Slack / Discord / 기타 Chat 클라이언트 -->
        <Rule groupRelation="and">
          <Image condition="contains">\Slack\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (7) Microsoft Visual Studio / .NET Installer -->
        <Rule groupRelation="and">
          <Image condition="contains">\Microsoft Visual Studio\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (8) .NET Framework / Windows Installer (MSI 기반) -->
        <Rule groupRelation="and">
          <Image condition="end with">msiexec.exe</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (9) Windows Defender / AV 엔진 자체 업데이트 -->
        <Rule groupRelation="and">
          <Image condition="contains">\ProgramData\Microsoft\Windows Defender\Platform\</Image>
          <TargetFilename condition="contains">\ProgramData\Microsoft\Windows Defender\Definition Updates\</TargetFilename>
        </Rule>

        <!-- (10) Chrome / Edge 자체 Installer (예: ChromeSetup.exe 등) -->
        <Rule groupRelation="and">
          <Image condition="contains">\ChromeSetup.exe</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (11) VSCode / JetBrains 제품군 설치 및 업데이트 -->
        <Rule groupRelation="and">
          <Image condition="contains">\AppData\Local\Programs\Microsoft VS Code\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (12) JetBrains Toolbox / IntelliJ / PyCharm 등 -->
        <Rule groupRelation="and">
          <Image condition="contains">\JetBrains\Toolbox\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (13) Steam / 게임 런처 업데이트 (선택적으로 허용) -->
        <Rule groupRelation="and">
          <Image condition="contains">\Steam\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (14) NVIDIA / AMD 그래픽 드라이버 설치 프로그램 -->
        <Rule groupRelation="and">
          <Image condition="contains">\NVIDIA\</Image>
          <TargetFilename condition="contains">\Program Files\NVIDIA Corporation\Installer2\</TargetFilename>
        </Rule>

        <!-- (15) Windows Update 에이전트 일부 동작 허용 (필요 시) -->
        <Rule groupRelation="and">
          <Image condition="end with">wuauclt.exe</Image>
          <TargetFilename condition="contains">\SoftwareDistribution\Download\</TargetFilename>
        </Rule>

        <!-- (16) Chocolatey / Winget 등 패키지 관리자 (개발 환경에서 사용 시) -->
        <Rule groupRelation="and">
          <Image condition="contains">\chocolatey\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (17) Winget -->
        <Rule groupRelation="and">
          <Image condition="contains">\App Installer\</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- (18) CefSharp Unpacking -->
        <Rule groupRelation="and">
          <Image condition="end with">CefSharp.BrowserSubprocess.exe</Image>
          <TargetFilename condition="contains">\chrome_Unpacker_BeginUnzipping</TargetFilename>
        </Rule>
    
        <!-- (19) Visual Studio Installer -->
        <Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files (x86)\Microsoft Visual Studio\Installer\</Image>
          <Image condition="end with">\Microsoft.VisualStudio.Setup.ServiceBackgroundDownload.exe</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
          <TargetFilename condition="end with">vs_setup_bootstrapper.exe</TargetFilename>
        </Rule>
    
        <!-- (20) BITS tmp 파일 -->
        <Rule groupRelation="and">
          <Image condition="is">C:\WINDOWS\System32\svchost.exe</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\BIT</TargetFilename>
        </Rule>
		
        <!-- (21) WinSCP 설치 프로그램 예외 -->
        <!-- 1단계: 설치 exe가 Temp 아래로 파일을 풀어낼 때 허용 -->
        <Rule groupRelation="and">
          <!-- 다운로드 폴더에서 실행되는 WinSCP 설치 파일 -->
          <Image condition="end with">WinSCP-6.5.5-Setup.exe</Image>
          <!-- 이 설치 파일이 AppData\Local\Temp 아래에 뭔가를 만들 때는 허용 -->
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

        <!-- 2단계: Inno Setup가 만드는 is-xxxx.tmp 폴더 내 실행 허용 -->
        <Rule groupRelation="and">
          <Image condition="contains">WinSCP</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\is-</TargetFilename>
        </Rule>

		<!-- (22) Windows 배경화면 애플리케이션 업데이트 -->
		<Rule groupRelation="and">
          <Image condition="begin with">C:\Program Files\WindowsApps\Microsoft.BingWallpaper</Image>
          <Image condition="end with">BingWallpaper.exe</Image>
          <TargetFilename condition="contains">\AppData\Local\Temp\</TargetFilename>
        </Rule>

		<!-- (23) OneDrive 패치 -->
		<Rule groupRelation="and">
          <Image condition="contains">\AppData\Local\Microsoft\OneDrive\</Image>
          <Image condition="end with">\OneDrivePatcher.exe</Image>
          <TargetFilename condition="contains all">\AppData\Local\Temp\;\OneDriveDeltaPatch\</TargetFilename>
        </Rule>

		<!-- (24) ALToolsManager 업데이트 -->
		<Rule groupRelation="and">
          <Image condition="is">C:\Program Files (x86)\ESTsoft\ALToolsManager\ALToolsManager.exe</Image>
          <TargetFilename condition="contains">\AppData\Roaming\ESTsoft\ALToolsManager\</TargetFilename>
        </Rule>

		<!-- (25) Windows Update 플랫폼이 업데이트 준비 과정에서 생성하는 정상 DLL -->
		<Rule groupRelation="and">
          <Image condition="begin with">C:\WINDOWS\SoftwareDistribution\Download\</Image>
          <Image condition="end with">\InstallUpdatePlatform.amd64fre.exe</Image>
          <TargetFilename condition="begin with">C:\Windows\Temp\</TargetFilename>
        </Rule>

		<!-- sysmon 업데이트 시, 임시 경로에 자신의 복사본을 만들고 작업을 수행 -->
		<Rule groupRelation="and">
          <Image condition="is">C:\Program Files\PLURA\Sysmon.exe</Image>
          <Image condition="end with">\AppData\Local\Temp\Sysmon.exe</Image>
        </Rule>
		  
      </FileExecutableDetected>
    </RuleGroup>

    <!-- NOTE: Event ID 27 (FileBlockExecutable) is intentionally NOT included -->
    <!-- ============================================================ -->
  </EventFiltering>
</Sysmon>
