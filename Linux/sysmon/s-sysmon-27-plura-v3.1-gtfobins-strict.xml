<!--
  PLURA_CONFIG_VERSION: linux-sysmon-filecreate-gtfobins-strict-v1.0
  PURPOSE: "Strict" variant (more writer binaries) to approximate Windows Sysmon EID 27 LOLBAS strict list.
  NOTE:
    - Uses EID 11 (FileCreate) for detection in place of Windows EID 27 blocking.
  GENERATED: 2025-12-16
-->
<Sysmon schemaversion="4.90">
  <EventFiltering>

    <!-- =========================================================
         Event ID 11: FileCreate
         ========================================================= -->

    <RuleGroup name="Include_MalwareDrop_Linux" groupRelation="or">
      <FileCreate onmatch="include">

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">/home/</TargetFilename>
          <TargetFilename condition="contains any">/Documents/;/Desktop/;/Downloads/;/Pictures/;/Videos/;/Music/;/Client_Contracts/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.zsh;.ksh;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">/root/</TargetFilename>
          <TargetFilename condition="contains any">/Downloads/;/Documents/;/Desktop/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">/tmp/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">/var/tmp/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">/dev/shm/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <TargetFilename condition="begin with">/run/user/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <Rule groupRelation="and">
          <TargetFilename condition="contains any">/var/www/;/srv/www/</TargetFilename>
          <TargetFilename condition="contains any">.php;.jsp;.asp;.aspx;.cgi;.pl;.py;.sh;.so;.bin;.elf</TargetFilename>
        </Rule>

      </FileCreate>
    </RuleGroup>

    <!-- Strict: broader writer coverage (more GTFOBins-like utilities) -->
    <RuleGroup name="Include_GTFOBins_Writers_Linux_Strict" groupRelation="or">
      <FileCreate onmatch="include">

        <!-- Core download/transfer/interpret tools -->
        <Rule groupRelation="and">
          <Image condition="contains any">/curl;/wget;/python;/python3;/perl;/ruby;/php;/node;/lua;/ssh;/scp;/sftp;/nc;/ncat;/socat;/ftp;/tftp;/base64;/openssl;/busybox;/git;/rsync</Image>
          <TargetFilename condition="contains any">/tmp/;/var/tmp/;/dev/shm/;/run/user/;/home/;/root/;/var/www/;/opt/;/srv/;/var/lib/</TargetFilename>
        </Rule>

        <!-- File writer utilities frequently abused via GTFOBins patterns -->
        <Rule groupRelation="and">
          <Image condition="contains any">/tee;/dd;/cat;/cp;/mv;/install;/printf;/xxd;/hexdump;/awk;/gawk;/sed</Image>
          <TargetFilename condition="contains any">/tmp/;/var/tmp/;/dev/shm/;/run/user/;/home/;/root/;/var/www/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.zsh;.ksh;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

        <!-- Archive/unpack tools -->
        <Rule groupRelation="and">
          <Image condition="contains any">/tar;/unzip;/7z;/gzip;/bzip2;/xz</Image>
          <TargetFilename condition="contains any">/tmp/;/var/tmp/;/dev/shm/;/run/user/;/home/;/root/</TargetFilename>
        </Rule>

        <!-- Shells: keep higher-signal by requiring exec/script-like names and high-risk dirs -->
        <Rule groupRelation="and">
          <Image condition="contains any">/bash;/sh;/dash;/zsh;/ksh</Image>
          <TargetFilename condition="contains any">/tmp/;/var/tmp/;/dev/shm/;/run/user/</TargetFilename>
          <TargetFilename condition="contains any">.sh;.bash;.zsh;.ksh;.py;.pl;.rb;.php;.js;.jar;.so;.bin;.run;.elf;.out;.AppImage</TargetFilename>
        </Rule>

      </FileCreate>
    </RuleGroup>

    <RuleGroup name="Exclude_LegitActivity_Linux" groupRelation="or">
      <FileCreate onmatch="exclude">

        <Rule groupRelation="and">
          <Image condition="contains any">/apt;/apt-get;/dpkg;/yum;/dnf;/rpm;/zypper;/pacman;/snap;/flatpak</Image>
          <TargetFilename condition="contains any">/tmp/;/var/tmp/;/var/cache/;/var/lib/</TargetFilename>
        </Rule>

        <TargetFilename condition="end with">.swp</TargetFilename>
        <TargetFilename condition="end with">.swx</TargetFilename>
        <TargetFilename condition="end with">.tmp</TargetFilename>
        <TargetFilename condition="end with">.part</TargetFilename>
        <TargetFilename condition="end with">.crdownload</TargetFilename>
        <TargetFilename condition="end with">~</TargetFilename>

      </FileCreate>
    </RuleGroup>

    <!-- =========================================================
         Event ID 1: ProcessCreate (optional correlation)
         ========================================================= -->
    <RuleGroup name="Include_Temp_Execution_Linux" groupRelation="or">
      <ProcessCreate onmatch="include">
        <Image condition="begin with">/tmp/</Image>
        <Image condition="begin with">/var/tmp/</Image>
        <Image condition="begin with">/dev/shm/</Image>
        <Image condition="begin with">/run/user/</Image>
      </ProcessCreate>
    </RuleGroup>

  </EventFiltering>
</Sysmon>
