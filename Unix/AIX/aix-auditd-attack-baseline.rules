# ===================================================================
# AIX AUDIT BASELINE — ATTACK DETECTION RULESET
# File: aix-auditd-attack-baseline.rules
# Purpose: Detect common intrusion, privilege escalation, credential
#          abuse, suspicious command, and file tampering activities.
# ===================================================================

#####################################################################
# 1. LOGIN & AUTHENTICATION (Credential Access / Brute Force)
#####################################################################
classes:
    LOGIN:       # 로그인 성공/실패
        events = LG_su, LG_login, LG_passwd, LG_faillog, LG_tty
    AUTH1:       # 인증 실패
        events = AT_passwd, AT_loginchk, AT_unauth
    AUTH2:       # 인증 우회 시도 및 권한 실패 이벤트
        events = AT_su, AT_rolechg, AT_tsh

#####################################################################
# 2. PRIVILEGE ESCALATION (EoP)
#####################################################################
classes:
    USER:
        events = US_su, US_sudo, US_roles
    PROC_Create:      # 프로세스 생성
        events = P_Create
    CMD_Exec:         # 명령 실행 추적
        events = C_Exec

#####################################################################
# 3. FILE ACCESS & INTEGRITY
#####################################################################
classes:
    FILE_Read:
        events = FR_read
    FILE_Write:
        events = FW_create, FW_write, FW_delete
    FS_Access:
        events = FS_perm, FS_attr

objects:
    critical_files:
        /etc/passwd
        /etc/shadow
        /etc/security/user
        /etc/hosts
        /etc/services
        /var/spool/cron/*
        /usr/bin/su
        /usr/bin/passwd

#####################################################################
# 4. NETWORK & REMOTE EXECUTION
#####################################################################
classes:
    NET:
        events = N_accept, N_connect, N_listen
    TCP:
        events = TCP_connect
    UDP:
        events = UDP_msg

#####################################################################
# 5. SHELL & COMMAND ABUSE
#####################################################################
classes:
    SHELL:
        events = SH_exec, SH_profile

#####################################################################
# 6. SYSTEM CONFIG / SERVICE MODIFICATIONS
#####################################################################
classes:
    RAS:
        events = R_change, R_config

#####################################################################
# 7. APPLY BASELINE TO THESE USERS
#####################################################################
users:
    root:
        auditclasses = LOGIN,AUTH1,AUTH2,USER,PROC_Create,CMD_Exec,FILE_Write,FS_Access,NET,SHELL,RAS
    appuser:
        auditclasses = LOGIN,USER,PROC_Create,CMD_Exec
    default:
        auditclasses = LOGIN,AUTH1

#####################################################################
# END OF FILE
#####################################################################
